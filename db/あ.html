<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Hexエスケープ デコーダー & ダウンローダー</title><style>body{font-family:sans-serif;padding:20px;line-height:1.6;}#message{margin-top:20px;font-weight:bold;color:#333;}#processButton{padding:10px 20px;cursor:pointer;background-color:#007bff;color:white;border:none;border-radius:5px;}#processButton:disabled{background-color:#cccccc;cursor:not-allowed;}.success{color:#28a745;}.error{color:#dc3545;}</style></head><body><h1>アセット定義デコーダー</h1><input type="file" id="fileInput" accept=".js,.txt"><button id="processButton" disabled>ファイルを処理してデコード済みJSONをダウンロード</button><div id="message"></div><script>const fileInput=document.getElementById('fileInput'),processButton=document.getElementById('processButton'),message=document.getElementById('message'),REGEX=/window\['packerplugin'\]\['json'\]\['texture'\]='(.*?)';/s;fileInput.addEventListener('change',()=>{processButton.disabled=fileInput.files.length===0;message.textContent=fileInput.files.length>0?`${fileInput.files[0].name}が選択されました。`:'';});function decodeHexEscapes(e){return e.replace(/\\x([0-9A-Fa-f]{2})/g,(e,t)=>{return String.fromCharCode(parseInt(t,16));})}function downloadFile(e,t,o){const n=new Blob([e],{type:o}),r=URL.createObjectURL(n),l=document.createElement('a');l.href=r;l.download=t;document.body.appendChild(l);l.click();document.body.removeChild(l);URL.revokeObjectURL(r);}processButton.addEventListener('click',()=>{const e=fileInput.files[0];if(!e){message.textContent='エラー:ファイルを選択してください。';message.className='error';return;}const t=new FileReader();t.onload=function(t){const o=t.target.result,n=o.match(REGEX);if(!n||n.length<2){message.textContent='エラー:ファイル内に目的のJSON文字列が見つかりませんでした。';message.className='error';return;}const r=n[1];try{const l=decodeHexEscapes(r);
                    
                    // 拡張子(.jsなど)の前に _decoded を挿入
                    const s=e.name.replace(/(\.[^.]+)$/, '_decoded$1'); 
                    
                    // 拡張子を維持しつつ、中身をテキストとしてダウンロード
                    downloadFile(l,s,'text/plain'); 

                    message.textContent=`✅成功！デコードされた${s}をダウンロードしました。`;message.className='success';}catch(e){message.textContent=`デコード処理中にエラーが発生しました:${e.message}`;message.className='error';console.error(e);}};t.readAsText(e);});</script></body></html>
