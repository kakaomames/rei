<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>パス/リンク抽出ツール</title><style>body{font-family:sans-serif;padding:20px;line-height:1.6;}#message{margin-top:20px;font-weight:bold;color:#333;}#processButton{padding:10px 20px;cursor:pointer;background-color:#007bff;color:white;border:none;border-radius:5px;}#processButton:disabled{background-color:#cccccc;cursor:not-allowed;}.success{color:#28a745;}.error{color:#dc3545;}</style></head><body><h1>パス/リンク抽出ツール</h1><input type="file" id="fileInput"><button id="processButton" disabled>リンク・パスを抽出してダウンロード</button><div id="message"></div><script>const fileInput=document.getElementById('fileInput'),processButton=document.getElementById('processButton'),message=document.getElementById('message');const REGEX=/((?:https?:\/\/|www\.)[^\s"']+|['"]?([\w\-\.\/]+\.(?:png|jpg|gif|js|css|html|json|txt|svg|mp3|wav))['"]?)/gi;fileInput.addEventListener('change',()=>{processButton.disabled=fileInput.files.length===0;message.textContent=fileInput.files.length>0?`${fileInput.files[0].name}が選択されました。`:'';});function downloadFile(e,t,o){const n=new Blob([e],{type:o}),r=URL.createObjectURL(n),l=document.createElement('a');l.href=r;l.download=t;document.body.appendChild(l);l.click();document.body.removeChild(l);URL.revokeObjectURL(r);}processButton.addEventListener('click',()=>{const e=fileInput.files[0];if(!e){message.textContent='エラー:ファイルを選択してください。';message.className='error';return;}const t=new FileReader();t.onload=function(t){const o=t.target.result;try{const s=new Set();let i;while((i=REGEX.exec(o))!==null){let l=i[1].replace(/^['"]|['"]$/g,'').trim();if(l){s.add(l);}}const n=Array.from(s).join('\n');if(n.length===0){message.textContent='⚠️警告:ファイルから有効なリンクやパスが見つかりませんでした。';message.className='error';return;}const r=e.name.replace(/\.[^.]+$/,'')+'_links.txt';downloadFile(n,r,'text/plain');message.textContent=`✅成功！${s.size}個のリンク・パスを${r}に抽出しました。`;message.className='success';}catch(e){message.textContent=`処理中にエラーが発生しました:${e.message}`;message.className='error';console.error(e);}};t.readAsText(e);});</script></body></html>
